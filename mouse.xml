<?xml version="1.0"?>
<mavlink>
    <version>3</version>
    <dialect>2</dialect>
    <enums>
        <enum name="MOUSE_MODE">
            <description>This enum defines the mode to be used</description>
            <entry value="0" name="MOUSE_MODE_STOP">
                <description>All motion of mouse treadmill is stopped</description>
            </entry>
            <entry value="1" name="MOUSE_MODE_SPEED">
                <description>Constanst speed is applied. Speed selected by PC message SPEED_SETPOINT.</description>
            </entry>
            <entry value="2" name="MOUSE_MODE_AUTO_LOAD">
                <description>Predefined speed profile is loaded</description>
            </entry>
            <entry value="3" name="MOUSE_MODE_AUTO_RUN">
                <description>Predefined speed profile is applied</description>
            </entry>
        </enum>
        <enum name="MOUSE_ERROR">
            <description>This enum defines the possible errors</description>
            <entry value="0" name="MOTOR_ERROR">
                <description>The motor driver flaged an error, this might be due to many sources, see datasheet of motor driver.</description>
            </entry>
            <entry value="1" name="MOTOR_LOW_SPEED">
                <description>The speed setpoint chosen is too low to be achieved.</description>
            </entry>
            <entry value="2" name="MOTOR_HIGH_SPEED">
                <description>The speed setpoint chosen is too high to be achieved.</description>
            </entry>
            <entry value="3" name="MOUSE_ROUTINE_TOO_LONG">
                <description>More than 255 points have been defined in the mouse routine.</description>
            </entry>
            <entry value="4" name="SENSOR_NOT_RESPONDING">
                <description>One sensor is not responding correctly.</description>
            </entry>
        </enum>
            <enum name="SENSOR_ID">
            <description>This enum defines the sensors directions</description>
            <entry value="0" name="SENSOR_X">
                <description>Sensor ID for X direction.</description>
            </entry>
            <entry value="1" name="SENSOR_Y">
                <description>Sensor ID for Y direction.</description>
            </entry>
        </enum>
    </enums>
    <messages>
        <message id="0" name="HEARTBEAT">
            <description>The heartbeat message shows that a system or component is present and responding. Sender = STM32 Receiver = PC
            </description>
            <field type="uint8_t" name="mode" enum="MOUSE_MODE">Actual operating mode</field>
            <field type="uint32_t" name="time">Time from boot of system</field>
        </message>
        <message id="1" name="SPEED_INFO">
            <description>The message giving the actual speed of the motor. Sender = STM32 Receiver = PC
            </description>
            <field type="uint32_t" name="time">Time from boot of system</field>
            <field type="float" name="speed_x">Speed in x direction</field>
            <field type="float" name="speed_y">Speed in y direction</field>
        </message>
         <message id="2" name="SPEED_SETPOINT">
            <description>The message is sent to send and validate the setpoint sent from computer. Sender = PC/STM32 Receiver = STM32/PC
            </description>
            <field type="float" name="setpoint_x">Speed setpoint in x direction</field>
            <field type="float" name="setpoint_y">Speed setpoint in y direction</field>
        </message>
        <message id="3" name="MODE_SELECTION">
            <description>This message is used to select the mode of the STM32 Sender = PC Receiver = STM32
            </description>
            <field type="uint8_t" name="mode" enum="MOUSE_MODE">Actual operating mode</field>
        </message>
        <message id="4" name="MOTOR_SETPOINT">
            <description>This message defines the raw motor input values. This values defines the Duty_Cycle up time for PWM signals. Sender = STM32 Receiver = PC
            </description>
            <field type="uint32_t" name="time">Time from boot of system</field>
            <field type="float" name="motor_x">Speed setpoint in x direction</field>
            <field type="float" name="motor_y">Speed setpoint in y direction</field>
        </message>
        <message id="5" name="POINT_LOADED">
            <description>This message is used to acknowledge the receipt of one point for auto mode Sender = STM32 Receiver = PC
            </description>
            <field type="uint8_t" name="point_id">Last ID of point loaded</field>
        </message>
        <message id="6" name="POINT">
            <description>This message is used to send one point for auto mode. Sender = PC Receiver = STM32
            </description>
            <field type="uint32_t" name="duration">Time during which the setpoint need to be kept</field>
            <field type="uint8_t" name="point_id">point ID</field>
            <field type="float" name="setpoint_x">Speed setpoint in x direction</field>
            <field type="float" name="setpoint_y">Speed setpoint in y direction</field>
        </message>
        <message id="7" name="ERROR">
            <description>This message is used to send errors Sender = STM32 Receiver = PC
            </description>
            <field type="uint32_t" name="time">Time from boot of system</field>
            <field type="uint8_t" name="error" enum="MOUSE_ERROR">error ID</field>
        </message>
        <message id="8" name="RAW_SENSOR">
	        <description>This message contains raw sensor values Sender = STM32 Receiver = PC
	        </description>
	        <field type="uint32_t" name="time">Time from boot of system</field>
	        <field type="uint8_t" name="sensor_id">0 for X, 1 for Y.</field>	
	        <field type="int16_t" name="delta_x">Displacement along sensor's x in counts per inch.</field>
	   		<field type="int16_t" name="delta_y">Displacement along sensor's y in counts per inch.</field>
	 		<field type="uint8_t" name="squal">Quality of the surface. For white paper is around 30.</field>
	 		<field type="uint8_t" name="lift">1 if the sensor is lifted (not measuring). 0 otherwise</field>	
	    	<field type="uint8_t" name="product_id">0x42 if the serial communication with the sensor works correctly.</field>	
	    </message>   
    </messages>
</mavlink>